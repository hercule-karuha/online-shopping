import{_ as G,b as H,g as Q,A as W,u as X,r as c,e as Y,h as q,o as i,c as B,i as t,a as b,t as k,l as d,m as n,q as v,w as O,v as $,E as Z,C as _,y as ee,z as ae}from"./index-43945a83.js";import{E as te,a as se}from"./el-tab-pane-f1874cb0.js";import{D as S}from"./DataList-e4682188.js";import{g as oe,a as E,b as L}from"./store-a6f281e4.js";import{P as C}from"./ProductItem-fd5e135e.js";import{P as le}from"./PurchaseListItem-07a4cb34.js";import{d as re}from"./product-252d41f2.js";import{m as V}from"./request-d304319d.js";import{s as de,a as ne}from"./search-ce04aa98.js";import"./el-input-853da7da.js";import"./el-popper-a281cd70.js";const R=A=>(ee("data-v-6729b6e6"),A=A(),ae(),A),ue={class:"info"},ie={class:"cover"},ce=["src"],ve={class:"name"},pe={key:0,class:"edit"},_e=R(()=>t("span",null,"编辑店铺",-1)),fe=R(()=>t("span",null,"商品上新",-1)),me={class:"search"},ge={class:"content"},he={class:"search-order"},we={class:"order-item"},ye={class:"top"},Se={class:"time"},Ie={class:"order-id"},Pe={class:"center"},be={class:"buttom"},ke={class:"send"},Ce={class:"receive"},Ae={__name:"StoreDetail",setup(A){const D=H(),{proxy:M}=Q(),f=W(),N=X(),m=c(""),g=c({}),x=c(!1),p=c(!1),u=c(!1),I=c(""),o=c("all");let l={};const r=c({list:[]}),T=()=>{r.value.list.forEach(a=>{a.sendAddress=JSON.parse(a.sendAddress),a.sendAddress=a.sendAddress.areaArr.join("  ")+"  "+a.sendAddress.detailAddress,a.receiveAdress=a.receiveAddress+"  "+a.phone})};Y(async()=>{const a=await oe(f.params.id);if(!a)return;g.value=a.data,D.userInfo&&D.userInfo.userId==g.value.userId&&(p.value=!0);const e={storeId:f.params.id,pageSize:"15",pageNo:"1",orderType:"0"},w=await E(e);w&&(r.value=w.data)});const j=async a=>{if(console.log(a.props),l={pageSize:"15",pageNo:"1",storeId:f.params.id},o.value==a.props.name&&!x.value)retuen;else if(o.value=a.props.name,o.value=="all")l.orderType="0";else if(o.value=="saleup")l.orderType="2";else if(o.value=="saledown")l.orderType="3";else if(o.value=="priceup")l.orderType="4";else if(o.value=="pricedown")l.orderType="5";else if(o.value=="orders"){l={pageSize:"15",pageNo:"1",storeId:f.params.id},u.value=!0;const e=await L(l);if(u.value=!1,!e)return;r.value=e.data,T();return}u.value=!0,E(l).then(e=>{e&&(r.value=e.data,u.value=!1)})},h=async a=>{if(l.pageNo=a.toString(),o.value=="orders"){const e=await L(l);if(!e)return;r.value=e.data,T();return}else{const e=await E(l);if(!e)return;r.value=e.data}},P=async a=>{await re({productId:a})&&(r.value.list=r.value.list.filter(w=>w.productId!=a),V.success("删除成功"))},z=a=>{if(!m.value||m.value.trim()==""){V.warning("请输入搜索关键字");return}a=="all"?N.push({path:"/product/list",query:{keyword:m.value}}):(l={pageSize:"15",pageNo:"1",storeId:f.params.id,keyword:m.value},de(l).then(e=>{e&&(r.value=e.data,x.value=!0)}))},F=async()=>{if(!I.value||I.value.trim()==""){V.warning("请输入搜索关键字");return}l={pageSize:"15",pageNo:"1",storeId:f.params.id,keyword:I.value};const a=await ne(l);a&&(r.value=a.data,T(),x.value=!0)};return(a,e)=>{const w=q("EditPen"),U=Z,J=q("CirclePlus"),y=se,K=te;return i(),B("main",null,[t("header",null,[t("div",ue,[t("div",ie,[t("img",{src:g.value.storeId?b(M).globalInfo.storeCoverUrl+g.value.storeId:"",alt:""},null,8,ce)]),t("div",ve,k(g.value.name),1),p.value?(i(),B("div",pe,[t("div",{onClick:e[0]||(e[0]=s=>b(N).push("/store/edit"))},[d(U,null,{default:n(()=>[d(w)]),_:1}),_e]),t("div",{onClick:e[1]||(e[1]=s=>b(N).push("/store/newProduct"))},[d(U,null,{default:n(()=>[d(J)]),_:1}),fe])])):v("",!0)]),t("div",me,[O(t("input",{type:"text","onUpdate:modelValue":e[2]||(e[2]=s=>m.value=s),placeholder:"搜索 商品"},null,512),[[$,m.value]]),t("div",null,[t("button",{onClick:e[3]||(e[3]=s=>z("all"))},"搜全部"),t("button",{onClick:e[4]||(e[4]=s=>z("inner"))},"搜本店")])])]),t("div",ge,[d(K,{modelValue:o.value,"onUpdate:modelValue":e[6]||(e[6]=s=>o.value=s),class:"demo-tabs",onTabClick:j},{default:n(()=>[d(y,{label:"全部",name:"all"},{default:n(()=>[o.value=="all"?(i(),_(S,{key:0,dataSource:r.value,loading:u.value,onChangePage:h},{default:n(({data:s})=>[d(C,{data:s,"show-edit":p.value,onDelProduct:P},null,8,["data","show-edit"])]),_:1},8,["dataSource","loading"])):v("",!0)]),_:1}),d(y,{label:"销量⬆️",name:"saleup"},{default:n(()=>[o.value=="saleup"?(i(),_(S,{key:0,dataSource:r.value,loading:u.value,onChangePage:h},{default:n(({data:s})=>[d(C,{data:s,"show-edit":p.value,onDelProduct:P},null,8,["data","show-edit"])]),_:1},8,["dataSource","loading"])):v("",!0)]),_:1}),d(y,{label:"销量⬇️",name:"saledown"},{default:n(()=>[o.value=="saledown"?(i(),_(S,{key:0,dataSource:r.value,loading:u.value,onChangePage:h},{default:n(({data:s})=>[d(C,{data:s,"show-edit":p.value,onDelProduct:P},null,8,["data","show-edit"])]),_:1},8,["dataSource","loading"])):v("",!0)]),_:1}),d(y,{label:"价格⬆️",name:"priceup"},{default:n(()=>[o.value=="priceup"?(i(),_(S,{key:0,dataSource:r.value,loading:u.value,onChangePage:h},{default:n(({data:s})=>[d(C,{data:s,"show-edit":p.value,onDelProduct:P},null,8,["data","show-edit"])]),_:1},8,["dataSource","loading"])):v("",!0)]),_:1}),d(y,{label:"价格⬇️",name:"pricedown"},{default:n(()=>[o.value=="pricedown"?(i(),_(S,{key:0,dataSource:r.value,loading:u.value,onChangePage:h},{default:n(({data:s})=>[d(C,{data:s,"show-edit":p.value,onDelProduct:P},null,8,["data","show-edit"])]),_:1},8,["dataSource","loading"])):v("",!0)]),_:1}),b(D).userInfo&&b(D).userInfo.userId==g.value.userId?(i(),_(y,{key:0,label:"订单",name:"orders"},{default:n(()=>[t("div",he,[O(t("input",{type:"text","onUpdate:modelValue":e[5]||(e[5]=s=>I.value=s),placeholder:"请输入商品名或订单号"},null,512),[[$,I.value]]),t("button",{onClick:F},"搜索销售记录")]),o.value=="orders"?(i(),_(S,{key:0,dataSource:r.value,flex:!1,onChangePage:h,loading:u.value},{default:n(({data:s})=>[t("div",we,[t("div",ye,[t("div",Se,k(s.time),1),t("div",Ie," 订单号："+k(s.orderId),1)]),t("div",Pe,[d(le,{data:s,tips:!0,bgc:!1},null,8,["data"])]),t("div",be,[t("div",ke,"发货地址:"+k(s.sendAddress),1),t("div",Ce,"收货地址"+k(s.receiveAdress),1)])])]),_:1},8,["dataSource","loading"])):v("",!0)]),_:1})):v("",!0)]),_:1},8,["modelValue"])])])}}},$e=G(Ae,[["__scopeId","data-v-6729b6e6"]]);export{$e as default};
