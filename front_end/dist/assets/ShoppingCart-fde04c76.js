import{D as w}from"./DataList-e4682188.js";import{_ as I,u as C,g as N,r as v,B as S,o as x,c as y,i as t,l as _,a as E,t as i,e as B,m as D,y as L,z}from"./index-43945a83.js";import{E as P}from"./el-input-number-57ff7060.js";import"./el-input-853da7da.js";import{E as U}from"./el-checkbox-4dbd9916.js";import{m as f}from"./request-d304319d.js";import{u as b,e as g}from"./purchaseList-c3137989.js";import{getShoppingCart as F}from"./user-f47ffe26.js";import"./el-popper-a281cd70.js";const j={class:"content"},M={class:"content"},O={class:"product-item"},R={class:"left"},q={class:"cover"},A=["src"],G={class:"price"},H={class:"sum"},J={class:"operator"},K={__name:"ShoppingCartItem",props:{data:{type:Object,default:()=>{}}},emits:["delete","select"],setup(e,{emit:h}){const n=e,d=C(),{proxy:p}=N(),m=b(),u=v(!1);S(u,a=>{a?m.add(n.data):m.remove(n.data)});const o=async a=>{f.confirm("确定要删除吗?",async()=>{await g({list:[{productId:a,num:"0"}]})&&(f.success("删除成功"),h("delete",a))})},c=a=>{d.push({path:"/product/detail/"+a})},l=async a=>{console.log(a),await g({list:[{productId:n.data.productId,num:a.toString()}]})};return(a,s)=>{const k=U,V=P;return x(),y("div",j,[t("div",M,[t("div",O,[t("div",R,[_(k,{size:"large",modelValue:u.value,"onUpdate:modelValue":s[0]||(s[0]=r=>u.value=r)},null,8,["modelValue"]),t("div",q,[t("img",{onClick:s[1]||(s[1]=r=>c(e.data.productId)),src:E(p).globalInfo.productCoverUrl+e.data.productId,alt:""},null,8,A)]),t("div",{onClick:s[2]||(s[2]=r=>c(e.data.productId)),class:"name"},i(e.data.productName),1)]),t("div",G,"¥"+i(e.data.price),1),_(V,{onChange:l,min:1,modelValue:e.data.num,"onUpdate:modelValue":s[3]||(s[3]=r=>e.data.num=r)},null,8,["modelValue"]),t("div",H,"¥"+i((e.data.price*e.data.num).toFixed(2)),1),t("div",J,[t("span",{onClick:s[4]||(s[4]=r=>o(e.data.productId))},"删除")])])])])}}},Q=I(K,[["__scopeId","data-v-8b9db1fe"]]);const $=e=>(L("data-v-9d0608e9"),e=e(),z(),e),T=$(()=>t("div",{class:"title"},[t("span",null,"购物车( 全部"+i(10)+" )")],-1)),W={class:"info"},X=$(()=>t("span",null,"已选商品("+i(0)+")",-1)),Y={class:"price"},Z={class:"content"},tt={__name:"ShoppingCart",setup(e){const h=C(),n=b(),d=v({list:[]}),p=v(0);B(async()=>{const o=await F({pageSize:"10",pageNo:"1"});o&&(d.value=o.data)}),S(n.list,o=>{p.value=o.reduce((c,l)=>c+l.price*l.num,0)},{immediate:!0});const m=()=>{if(n.list.length===0){f.warning("请至少选择一件商品");return}console.log("purchase",n.list),h.push("/purchase")},u=o=>{d.value.list=d.value.list.filter(c=>c.productId!==o)};return(o,c)=>(x(),y("main",null,[t("header",null,[T,t("div",W,[X,t("span",Y,i(p.value.toFixed(2)),1),t("button",{onClick:m},"结 算")])]),t("div",Z,[_(w,{"data-source":d.value,flex:!1},{default:D(({data:l})=>[_(Q,{data:l,onDelete:u},null,8,["data"])]),_:1},8,["data-source"])])]))}},it=I(tt,[["__scopeId","data-v-9d0608e9"]]);export{it as default};
